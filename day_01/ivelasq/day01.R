library(tidyverse)

# Input -------------------------------------------------------------------

input <- c(1227L, 1065L, 329L, 1063L, 1889L, 1700L, 1805L, 1373L, 389L, 1263L, 1276L, 1136L, 1652L, 1981L, 1406L, 1249L, 1197L, 1379L, 1050L, 1791L, 1703L, 2001L, 1842L, 1707L, 1486L, 1204L, 1821L, 1807L, 1712L, 1871L, 1599L, 1390L, 1219L, 1612L, 1980L, 1857L, 1511L, 1702L, 1455L, 1303L, 1052L, 1754L, 1545L, 1488L, 1848L, 1236L, 1549L, 1887L, 1970L, 1123L, 1686L, 1404L, 1688L, 1106L, 1296L, 401L, 1829L, 1693L, 1389L, 1957L, 914L, 1176L, 1348L, 1275L, 1624L, 1401L, 1045L, 1396L, 1352L, 1569L, 1060L, 1235L, 1679L, 1503L, 1340L, 1872L, 1410L, 1077L, 958L, 1681L, 1189L, 1466L, 1087L, 1852L, 1293L, 1139L, 1300L, 1323L, 661L, 1388L, 1983L, 1325L, 1112L, 1774L, 1858L, 1785L, 1616L, 1255L, 1198L, 1354L, 1124L, 1834L, 1417L, 1918L, 1496L, 33L, 1150L, 1861L, 1172L, 2006L, 1199L, 1558L, 1919L, 1620L, 1613L, 1710L, 1477L, 1592L, 1709L, 1909L, 1670L, 1922L, 1840L, 1768L, 1982L, 1193L, 1736L, 1877L, 1770L, 1191L, 1433L, 1072L, 1148L, 1225L, 1147L, 1171L, 1424L, 1913L, 1228L, 1339L, 1814L, 1504L, 1251L, 1240L, 1272L, 1500L, 1927L, 1428L, 1641L, 1453L, 1729L, 1976L, 1808L, 1180L, 1024L, 1108L, 1085L, 1669L, 1636L, 1005L, 1520L, 1929L, 1626L, 1551L, 1234L, 1988L, 1256L, 1524L, 1571L, 1506L, 1977L, 1749L, 1408L, 1540L, 1934L, 1810L, 1328L, 1910L, 1478L, 1600L, 1699L, 1413L, 1446L, 1798L, 1013L, 1998L, 1661L, 1058L, 1051L, 1220L, 1447L, 1675L, 1912L, 1668L, 1932L, 1962L, 1055L, 1757L, 1116L, 1090L)

# Code --------------------------------------------------------------------

filter <- function(x, y) x + y != 2020

sums <-
  cross2(input, input, .filter = filter) %>%
  map(lift(`*`)) %>% 
  pluck(1)

print(sums)

filter2 <- function(x, y, z) x + y + z != 2020

funs <- function(x, y, z) {
  `*`(`*`(x, y), z)
}

sums2 <-
  cross3(input, input, input, .filter = filter2) 

sums3 <-
  sums2 %>% 
  pmap(~ funs(..1, ..2, ..3)) %>% 
  pluck(2)